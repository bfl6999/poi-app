import{a as L}from"./chunk-6DRDY65T.js";import{A as G,B as V,C as _,D as q,I as D,b as O,d as y,e as U,f as T,m as M,p as j,r as k,s as A,t as B}from"./chunk-C4635AQ6.js";import"./chunk-RXWWUHP3.js";import"./chunk-QUJFQN2Y.js";import"./chunk-S3FFCQW7.js";import"./chunk-DOTHXVNP.js";import"./chunk-AWJPMP66.js";import"./chunk-DZ63SHBZ.js";import"./chunk-N3ULCH4Z.js";import"./chunk-A6U5T4IK.js";import"./chunk-BYMGTA2M.js";import"./chunk-FFMQGMXV.js";import"./chunk-WVCYVA7Q.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-BQTEGPC7.js";import"./chunk-CKP3SGE2.js";import"./chunk-M7AYFT6S.js";import"./chunk-R265GKSD.js";import{$a as s,G as p,H as t,I as i,J as r,O as I,X as n,ab as E,bb as F,ec as R,fb as P,gb as S,hb as x,kb as C,kc as z,lc as w,mb as N,pa as g,v as c,w as m,wa as b,y as f,ya as v}from"./chunk-CP2QVCAP.js";import"./chunk-EVXCY5NW.js";import"./chunk-JXNEG2Q2.js";import"./chunk-FUY72XGA.js";import"./chunk-EQDBGDMV.js";import"./chunk-WESY2VG5.js";import"./chunk-M2X7KQLB.js";import"./chunk-XTVTS2NW.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{f as h}from"./chunk-D7YYRZS5.js";var te=(()=>{class d{constructor(e,o,a,l,u){this.route=e,this.poiService=o,this.fb=a,this.auth=l,this.router=u,this.user=null}ngOnInit(){this.poiForm=this.fb.group({name:["",s.required],location:["",s.required],description:[""],imageUrl:[""],lat:["",s.required],lng:["",s.required]}),this.poiId=this.route.snapshot.paramMap.get("id")||"",w(this.auth,e=>{this.user=e,this.poiId&&this.loadPOI()})}loadPOI(){this.poiService.getPOI(this.poiId).subscribe({next:e=>{this.poiForm.patchValue({name:e.name,location:e.location,description:e.description,imageUrl:e.imageUrl,lat:e.coordinates?.lat,lng:e.coordinates?.lng})},error:e=>console.error("Error al cargar el POI para editar",e)})}updatePOI(){return h(this,null,function*(){if(this.poiForm.invalid||!this.user)return;let e=parseFloat(this.poiForm.value.lat),o=parseFloat(this.poiForm.value.lng),a={name:this.poiForm.value.name,location:this.poiForm.value.location,description:this.poiForm.value.description,imageUrl:this.poiForm.value.imageUrl,coordinates:{lat:e,lng:o},geo:{type:"Point",coordinates:[o,e]}};try{let l=yield z(this.user);this.poiService.updatePOI(this.poiId,a,l).subscribe({next:()=>{alert("POI actualizado con \xE9xito"),this.router.navigate(["/poi",this.poiId])},error:u=>{console.error("Error al actualizar POI:",u),alert("Error al actualizar el POI")}})}catch(l){console.error("Error autenticando usuario:",l)}})}static{this.\u0275fac=function(o){return new(o||d)(m(b),m(L),m(C),m(R),m(v))}}static{this.\u0275cmp=f({type:d,selectors:[["app-edit-poi"]],decls:34,vars:2,consts:[["slot","start"],["defaultHref","/home"],[1,"ion-padding"],[3,"ngSubmit","formGroup"],["position","floating"],["formControlName","name"],["formControlName","location"],["formControlName","description"],["formControlName","imageUrl"],["type","number","formControlName","lat"],["type","number","formControlName","lng"],["expand","block","type","submit",3,"disabled"]],template:function(o,a){o&1&&(t(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),n(3,"Editar POI"),i(),t(4,"ion-buttons",0),r(5,"ion-back-button",1),i()()(),t(6,"ion-content",2)(7,"form",3),I("ngSubmit",function(){return a.updatePOI()}),t(8,"ion-item")(9,"ion-label",4),n(10,"Nombre"),i(),r(11,"ion-input",5),i(),t(12,"ion-item")(13,"ion-label",4),n(14,"Ubicaci\xF3n"),i(),r(15,"ion-input",6),i(),t(16,"ion-item")(17,"ion-label",4),n(18,"Descripci\xF3n"),i(),r(19,"ion-textarea",7),i(),t(20,"ion-item")(21,"ion-label",4),n(22,"URL de imagen"),i(),r(23,"ion-input",8),i(),t(24,"ion-item")(25,"ion-label",4),n(26,"Latitud"),i(),r(27,"ion-input",9),i(),t(28,"ion-item")(29,"ion-label",4),n(30,"Longitud"),i(),r(31,"ion-input",10),i(),t(32,"ion-button",11),n(33,"Guardar cambios"),i()()()),o&2&&(c(7),p("formGroup",a.poiForm),c(25),p("disabled",a.poiForm.invalid))},dependencies:[g,N,P,E,F,S,x,D,U,T,M,j,k,A,B,G,V,_,O,y,q],encapsulation:2})}}return d})();export{te as EditPoiPage};
